<app-centered-layout>
  <div
    class="mx-auto max-w-5xl overflow-hidden rounded-2xl bg-default-950/40 backdrop-blur-2xl"
  >
    <div class="grid gap-10 lg:grid-cols-2">
      <auth-image />

      <div class="flex h-full flex-col p-10 lg:ps-0">
        <div class="pb-10">
          <a href="index.html" class="flex">
            <img src="assets/images/logo.png" alt="dark logo" class="h-10" />
          </a>
        </div>
        <div class="my-auto">
          <h4 class="mb-3 text-2xl font-bold text-white">Reset Password</h4>
          <p class="mb-8 max-w-sm text-default-300">
            Enter your email address and verification code to receive a password
            reset email.
          </p>

          <form
            [formGroup]="resetPasswordForm"
            (ngSubmit)="submitForm()"
            class="text-start"
          >
            <!-- Username -->
            <div class="mb-4">
              <label
                for="username"
                class="mb-2 block text-base/normal font-semibold text-default-200"
                >Email</label
              >
              <input
                class="block w-full rounded border-default-200 border-white/10 bg-transparent px-3 py-1.5 text-white/80 focus:border-white/25 focus:ring-transparent"
                type="text"
                id="username"
                formControlName="username"
                placeholder="Enter your email"
              />
              <div
                *ngIf="
                  resetPasswordForm.get('username')?.invalid &&
                  resetPasswordForm.get('username')?.touched
                "
                class="text-red-500 mt-1 text-sm"
              >
                <span
                  *ngIf="
                    resetPasswordForm.get('username')?.errors?.['required']
                  "
                  >Username is required</span
                >
              </div>
            </div>

            <!-- Verification Code -->
            <div class="mb-4">
              <label
                for="verifyCode"
                class="mb-2 block text-base/normal font-semibold text-default-200"
                >Verification Code</label
              >
              <div class="flex items-center gap-3">
                <input
                  class="block w-full rounded border-default-200 border-white/10 bg-transparent px-3 py-1.5 text-white/80 focus:border-white/25 focus:ring-transparent"
                  type="text"
                  id="verifyCode"
                  formControlName="verifyCode"
                  placeholder="Enter verification code"
                />
                <div class="flex-shrink-0">
                  <img
                    [src]="kaptchaUrl"
                    alt="Verification code"
                    class="h-10 cursor-pointer rounded"
                    (click)="refreshKaptcha()"
                  />
                </div>
              </div>
              <div
                *ngIf="
                  resetPasswordForm.get('verifyCode')?.invalid &&
                  resetPasswordForm.get('verifyCode')?.touched
                "
                class="text-red-500 mt-1 text-sm"
              >
                <span
                  *ngIf="
                    resetPasswordForm.get('verifyCode')?.errors?.['required']
                  "
                  >Verification code is required</span
                >
              </div>
            </div>

            <div class="text-center">
              <button
                class="bg-primary-600/90 hover:bg-primary-600 group mt-5 inline-flex w-full items-center justify-center rounded-lg px-6 py-2 text-white backdrop-blur-2xl transition-all duration-500"
                type="submit"
                [disabled]="isLoading || countdownTime > 0"
              >
                <span class="fw-bold" *ngIf="countdownTime <= 0"
                  >Reset Password</span
                >
                <span class="fw-bold" *ngIf="countdownTime > 0"
                  >Resend in {{ countdownTime }}s</span
                >
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="mt-5 w-full text-center">
    <p class="text-base font-medium leading-6 text-default-300">
      Back To
      <a routerLink="/auth/login" class="ms-1 font-semibold text-primary"
        >Log In</a
      >
    </p>
  </div>
</app-centered-layout>
